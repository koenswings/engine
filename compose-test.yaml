# This file is used by Docker Dev Environment to create the dev container
services:
  engine:
    # Infinite loop to keep the container running - use when you don't have a server running
    # entrypoint:
    # - sleep
    # - infinity
    build: 
      context: .
      target: base
    init: true
    restart: always
    privileged: true
    devices:
      - "/dev/usb:/dev/usb"
      #- "/dev:/dev"
    cap_add:
      - SYS_ADMIN
    volumes:
      - type: bind
        source: /var/run/docker.sock
        target: /var/run/docker.sock
      - type: bind
        source: /engine
        target: /engine
    command: bash -c "cd /engine && npm config set prefer-offline=true && pnpm run install_packages && pnpm run dev" 

